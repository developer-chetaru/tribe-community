{
    "openapi": "3.0.0",
    "info": {
        "title": "Tribe Community API",
        "description": "Auto-generated API documentation for Tribe Community Platform. Includes billing, payments, subscriptions, and user management endpoints.",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost",
            "description": "API Server"
        }
    ],
    "paths": {
        "/api/basecamp/stripe-config": {
            "get": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Get Stripe configuration for mobile app",
                "description": "Retrieve Stripe publishable key and payment configuration for initializing Stripe SDK in mobile applications. This endpoint does not require authentication as it only returns public configuration.",
                "operationId": "a9bfe397f7a7f693c14a7874b22a7ce8",
                "responses": {
                    "200": {
                        "description": "Stripe configuration retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Stripe configuration retrieved successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "publishable_key": {
                                                    "description": "Stripe publishable key for client-side SDK",
                                                    "type": "string",
                                                    "example": "pk_test_51..."
                                                },
                                                "currency": {
                                                    "description": "Payment currency",
                                                    "type": "string",
                                                    "example": "usd"
                                                },
                                                "monthly_price": {
                                                    "description": "Monthly subscription price in USD",
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Failed to retrieve Stripe configuration."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/basecamp/invoices": {
            "get": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Get basecamp user invoices",
                "description": "Retrieve all invoices for the authenticated basecamp user. Returns invoices with status, amounts, and payment information.",
                "operationId": "4006b21b58b6f34af189db853093d9b5",
                "parameters": [
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter invoices by status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "unpaid",
                                "paid",
                                "pending",
                                "overdue"
                            ],
                            "example": "unpaid"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Page number for pagination",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Invoices retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invoices retrieved successfully"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    },
                                                    "invoice_number": {
                                                        "type": "string",
                                                        "example": "INV-202512-0001"
                                                    },
                                                    "tier": {
                                                        "type": "string",
                                                        "example": "basecamp"
                                                    },
                                                    "total_amount": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 10
                                                    },
                                                    "status": {
                                                        "type": "string",
                                                        "example": "unpaid"
                                                    },
                                                    "invoice_date": {
                                                        "type": "string",
                                                        "format": "date",
                                                        "example": "2025-01-05"
                                                    },
                                                    "due_date": {
                                                        "type": "string",
                                                        "format": "date",
                                                        "example": "2025-01-12"
                                                    },
                                                    "paid_at": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2025-01-05T10:30:00.000000Z",
                                                        "nullable": true
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "current_page": {
                                            "type": "integer",
                                            "example": 1
                                        },
                                        "total": {
                                            "type": "integer",
                                            "example": 5
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - User is not a basecamp user",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Only basecamp users can access this endpoint."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/basecamp/subscription": {
            "get": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Get basecamp user subscription details",
                "description": "Retrieve subscription details for the authenticated basecamp user including status, billing dates, and tier information.",
                "operationId": "4cd585de887c3f76d45d67c1b68446fd",
                "responses": {
                    "200": {
                        "description": "Subscription details retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Subscription details retrieved successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "tier": {
                                                    "type": "string",
                                                    "example": "basecamp"
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "enum": [
                                                        "active",
                                                        "inactive",
                                                        "cancelled"
                                                    ],
                                                    "example": "active"
                                                },
                                                "user_count": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "current_period_start": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-01-05T00:00:00.000000Z",
                                                    "nullable": true
                                                },
                                                "current_period_end": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-02-05T00:00:00.000000Z",
                                                    "nullable": true
                                                },
                                                "next_billing_date": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-02-05T00:00:00.000000Z",
                                                    "nullable": true
                                                },
                                                "monthly_price": {
                                                    "description": "Monthly subscription price in USD",
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - User is not a basecamp user",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Only basecamp users can access this endpoint."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Subscription not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Subscription not found."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/basecamp/payment-intent": {
            "post": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Create Stripe payment intent for basecamp invoice",
                "description": "Create a Stripe payment intent for a basecamp user's invoice. Returns client_secret for Stripe.js integration. Requires an unpaid invoice.",
                "operationId": "6f964971f30037ec26bfb56b20343756",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "invoice_id"
                                ],
                                "properties": {
                                    "invoice_id": {
                                        "description": "ID of the invoice to pay",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment intent created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payment intent created successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "client_secret": {
                                                    "description": "Stripe payment intent client secret for frontend integration",
                                                    "type": "string",
                                                    "example": "pi_1234567890_secret_..."
                                                },
                                                "payment_intent_id": {
                                                    "description": "Stripe payment intent ID",
                                                    "type": "string",
                                                    "example": "pi_1234567890"
                                                },
                                                "amount": {
                                                    "description": "Payment amount in USD",
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                },
                                                "currency": {
                                                    "type": "string",
                                                    "example": "usd"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Invoice not found or already paid",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invoice not found or already paid."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - User is not a basecamp user or invoice doesn't belong to user",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "You can only pay your own invoices."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Failed to create payment intent."
                                        },
                                        "error": {
                                            "type": "string",
                                            "example": "Error message"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/basecamp/confirm-payment": {
            "post": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Confirm payment for basecamp invoice",
                "description": "Confirm and process payment for a basecamp invoice after successful Stripe payment. Updates invoice status, creates payment record, and activates subscription.",
                "operationId": "d59ee2700e9365ec1f625a1db88fbb04",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "invoice_id",
                                    "payment_intent_id"
                                ],
                                "properties": {
                                    "invoice_id": {
                                        "description": "ID of the invoice being paid",
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "payment_intent_id": {
                                        "description": "Stripe payment intent ID",
                                        "type": "string",
                                        "example": "pi_1234567890"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment confirmed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payment confirmed successfully. Your subscription is now active."
                                        },
                                        "data": {
                                            "properties": {
                                                "payment_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "invoice_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "invoice_status": {
                                                    "type": "string",
                                                    "example": "paid"
                                                },
                                                "subscription_status": {
                                                    "type": "string",
                                                    "example": "active"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Payment already processed or invalid payment intent",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payment already processed or invalid payment intent."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "You can only confirm payments for your own invoices."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Failed to confirm payment."
                                        },
                                        "error": {
                                            "type": "string",
                                            "example": "Error message"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/basecamp/invoice/{id}/view": {
            "get": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "View invoice details",
                "description": "Retrieve detailed invoice information including invoice items, payment details, subscription information, and payment method details. Returns complete invoice data for viewing in mobile app.",
                "operationId": "d48c374c6ed905889b01b7a18ce0d285",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Invoice ID",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Invoice details retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invoice details retrieved successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "invoice_number": {
                                                    "type": "string",
                                                    "example": "INV-202512-0001"
                                                },
                                                "tier": {
                                                    "type": "string",
                                                    "example": "basecamp"
                                                },
                                                "user_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "subscription_id": {
                                                    "type": "integer",
                                                    "example": 1,
                                                    "nullable": true
                                                },
                                                "user_count": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "price_per_user": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                },
                                                "subtotal": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                },
                                                "tax_amount": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 0
                                                },
                                                "total_amount": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 10
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "enum": [
                                                        "unpaid",
                                                        "paid",
                                                        "pending",
                                                        "overdue"
                                                    ],
                                                    "example": "paid"
                                                },
                                                "invoice_date": {
                                                    "type": "string",
                                                    "format": "date",
                                                    "example": "2025-01-05"
                                                },
                                                "due_date": {
                                                    "type": "string",
                                                    "format": "date",
                                                    "example": "2025-01-12"
                                                },
                                                "paid_at": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-01-05T10:30:00.000000Z",
                                                    "nullable": true
                                                },
                                                "created_at": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-01-05T10:30:00.000000Z"
                                                },
                                                "updated_at": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2025-01-05T10:30:00.000000Z"
                                                },
                                                "subscription": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "tier": {
                                                            "type": "string",
                                                            "example": "basecamp"
                                                        },
                                                        "status": {
                                                            "type": "string",
                                                            "example": "active"
                                                        }
                                                    },
                                                    "type": "object",
                                                    "nullable": true
                                                },
                                                "payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "amount": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "example": 10
                                                            },
                                                            "payment_method": {
                                                                "type": "string",
                                                                "example": "card"
                                                            },
                                                            "transaction_id": {
                                                                "type": "string",
                                                                "example": "pi_1234567890"
                                                            },
                                                            "status": {
                                                                "type": "string",
                                                                "example": "completed"
                                                            },
                                                            "payment_date": {
                                                                "type": "string",
                                                                "format": "date",
                                                                "example": "2025-01-05"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                },
                                                "user": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "first_name": {
                                                            "type": "string",
                                                            "example": "John"
                                                        },
                                                        "last_name": {
                                                            "type": "string",
                                                            "example": "Doe"
                                                        },
                                                        "email": {
                                                            "type": "string",
                                                            "example": "john@example.com"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - User cannot access this invoice",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "You can only view your own invoices."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Invoice not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invoice not found."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/basecamp/invoice/{id}/download": {
            "get": {
                "tags": [
                    "Basecamp Billing",
                    "Basecamp Users"
                ],
                "summary": "Download invoice as PDF/HTML",
                "description": "Download invoice as HTML file that can be printed as PDF. Returns invoice HTML content with proper headers for download. Mobile apps can save this HTML and convert to PDF or display in webview.",
                "operationId": "88d705b530d7ff324609fabe3a27ffb3",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Invoice ID",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Invoice downloaded successfully",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "description": "HTML content of the invoice",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthorized. Please login."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Forbidden - User cannot download this invoice",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "You can only download your own invoices."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Invoice not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invoice not found."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/submit-payment": {
            "post": {
                "tags": [
                    "Payments"
                ],
                "summary": "Submit payment for an invoice",
                "description": "Submit a payment for an invoice. Directors can submit payments for invoices from their organisation.",
                "operationId": "2cce795897f811f0d988e9906b354752",
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "required": [
                                    "invoice_id",
                                    "payment_method",
                                    "amount"
                                ],
                                "properties": {
                                    "invoice_id": {
                                        "description": "ID of the invoice to pay",
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "payment_method": {
                                        "description": "Payment method used",
                                        "type": "string",
                                        "enum": [
                                            "bank_transfer",
                                            "credit_card",
                                            "paypal",
                                            "other"
                                        ],
                                        "example": "bank_transfer"
                                    },
                                    "amount": {
                                        "description": "Payment amount",
                                        "type": "number",
                                        "format": "float",
                                        "example": 90
                                    },
                                    "transaction_id": {
                                        "description": "Transaction ID from payment provider",
                                        "type": "string",
                                        "example": "TXN-123456",
                                        "nullable": true
                                    },
                                    "payment_notes": {
                                        "description": "Additional payment notes",
                                        "type": "string",
                                        "example": "Payment made via bank transfer",
                                        "nullable": true
                                    },
                                    "payment_proof": {
                                        "description": "Payment proof document/image (max 2MB)",
                                        "type": "string",
                                        "format": "binary",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        },
                        "application/json": {
                            "schema": {
                                "required": [
                                    "invoice_id",
                                    "payment_method",
                                    "amount"
                                ],
                                "properties": {
                                    "invoice_id": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "payment_method": {
                                        "type": "string",
                                        "enum": [
                                            "bank_transfer",
                                            "credit_card",
                                            "paypal",
                                            "other"
                                        ],
                                        "example": "bank_transfer"
                                    },
                                    "amount": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 90
                                    },
                                    "transaction_id": {
                                        "type": "string",
                                        "example": "TXN-123456",
                                        "nullable": true
                                    },
                                    "payment_notes": {
                                        "type": "string",
                                        "example": "Payment made via bank transfer",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment submitted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payment submitted successfully. It will be reviewed by admin."
                                        },
                                        "data": {
                                            "properties": {
                                                "payment_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "invoice_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "amount": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 90
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "pending"
                                                },
                                                "payment_date": {
                                                    "type": "string",
                                                    "format": "date",
                                                    "example": "2025-12-24"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - User does not have permission"
                    },
                    "404": {
                        "description": "Invoice not found"
                    },
                    "422": {
                        "description": "Validation error"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/payments": {
            "get": {
                "tags": [
                    "Payments"
                ],
                "summary": "Get payment history",
                "description": "Retrieve payment history for the authenticated user's organisation. Directors can view payments for their organisation.",
                "operationId": "a8de634f39060a36c0ca7210aa25f679",
                "parameters": [
                    {
                        "name": "invoice_id",
                        "in": "query",
                        "description": "Filter payments by invoice ID",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter payments by status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "pending",
                                "completed",
                                "failed"
                            ],
                            "example": "pending"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Page number for pagination",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Payments retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payments retrieved successfully"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    },
                                                    "invoice_id": {
                                                        "type": "integer",
                                                        "example": 1
                                                    },
                                                    "invoice_number": {
                                                        "type": "string",
                                                        "example": "INV-202512-0001"
                                                    },
                                                    "amount": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 90
                                                    },
                                                    "payment_method": {
                                                        "type": "string",
                                                        "example": "bank_transfer"
                                                    },
                                                    "status": {
                                                        "type": "string",
                                                        "example": "pending"
                                                    },
                                                    "payment_date": {
                                                        "type": "string",
                                                        "format": "date",
                                                        "example": "2025-12-24"
                                                    },
                                                    "transaction_id": {
                                                        "type": "string",
                                                        "example": "TXN-123456",
                                                        "nullable": true
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "current_page": {
                                            "type": "integer",
                                            "example": 1
                                        },
                                        "total": {
                                            "type": "integer",
                                            "example": 10
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/login-admin": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Admin/User Login",
                "description": "Authenticate user and return JWT token with user details",
                "operationId": "bd6a641df622dac8027cf943d59b1d73",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password",
                                    "deviceType",
                                    "deviceId",
                                    "fcmToken"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "user@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "example": "password123"
                                    },
                                    "deviceType": {
                                        "type": "string",
                                        "example": "ios"
                                    },
                                    "deviceId": {
                                        "type": "string",
                                        "example": "device-uuid-123"
                                    },
                                    "fcmToken": {
                                        "type": "string",
                                        "example": "fcm-token-123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "token": {
                                            "type": "string",
                                            "example": "eyJ0eXAiOiJKV1QiLCJhbGc..."
                                        },
                                        "user": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Invalid credentials"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/register": {
            "post": {
                "tags": [
                    "Authentication",
                    "Basecamp Users"
                ],
                "summary": "Register a new basecamp user",
                "description": "Register a new basecamp user account. Basecamp users are individual users who pay $10/month subscription. The user is automatically assigned the 'basecamp' role and receives a verification email. Returns JWT token for immediate authentication.",
                "operationId": "8a56853624e025573120a09a4c75d468",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "first_name",
                                    "last_name",
                                    "email",
                                    "password",
                                    "password_confirmation"
                                ],
                                "properties": {
                                    "first_name": {
                                        "description": "User's first name",
                                        "type": "string",
                                        "example": "John"
                                    },
                                    "last_name": {
                                        "description": "User's last name",
                                        "type": "string",
                                        "example": "Doe"
                                    },
                                    "email": {
                                        "description": "User's email address (must be unique)",
                                        "type": "string",
                                        "format": "email",
                                        "example": "john@example.com"
                                    },
                                    "password": {
                                        "description": "Password must contain uppercase, lowercase, number and special character, minimum 8 characters",
                                        "type": "string",
                                        "format": "password",
                                        "example": "Password123!@#"
                                    },
                                    "password_confirmation": {
                                        "description": "Password confirmation (must match password)",
                                        "type": "string",
                                        "format": "password",
                                        "example": "Password123!@#"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Registration successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "User registered successfully"
                                        },
                                        "user": {
                                            "description": "Created user object",
                                            "type": "object"
                                        },
                                        "token": {
                                            "description": "JWT token for authentication",
                                            "type": "string",
                                            "example": "eyJ0eXAiOiJKV1QiLCJhbGc..."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Validation failed"
                                        },
                                        "details": {
                                            "type": "string",
                                            "example": "The email has already been taken."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "example": "Registration failed"
                                        },
                                        "details": {
                                            "type": "string",
                                            "example": "Error message"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/billing/refunds/process": {
            "post": {
                "tags": [
                    "Billing - Refunds"
                ],
                "summary": "Process a refund request",
                "description": "Processes a refund for a Stripe payment. Supports full or partial refunds. Requires director or super_admin role.",
                "operationId": "b7160417acca99dcbcbccf02a4fe6262",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "payment_id",
                                    "reason"
                                ],
                                "properties": {
                                    "payment_id": {
                                        "description": "ID of the payment record to refund",
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "reason": {
                                        "description": "Reason for refund",
                                        "type": "string",
                                        "enum": [
                                            "overcharge",
                                            "duplicate_payment",
                                            "service_cancellation",
                                            "module_removal",
                                            "other"
                                        ],
                                        "example": "overcharge"
                                    },
                                    "amount": {
                                        "description": "Partial refund amount (optional, defaults to full refund)",
                                        "type": "number",
                                        "format": "float",
                                        "example": 50,
                                        "nullable": true
                                    },
                                    "description": {
                                        "description": "Additional refund description",
                                        "type": "string",
                                        "maxLength": 500,
                                        "example": "Customer requested refund due to billing error",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Refund processed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Refund processed successfully"
                                        },
                                        "refund": {
                                            "description": "Stripe refund object",
                                            "properties": {
                                                "id": {
                                                    "type": "string",
                                                    "example": "re_1234567890"
                                                },
                                                "amount": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 50
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "succeeded"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Invalid refund request or payment already refunded"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Payment not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/refunds/history": {
            "get": {
                "tags": [
                    "Billing - Refunds"
                ],
                "summary": "Get refund history",
                "description": "Retrieves refund history with optional filtering by organisation or subscription. Requires director or super_admin role.",
                "operationId": "35d975efe9d6ef80b7fd9c2879b9ca1f",
                "parameters": [
                    {
                        "name": "organisation_id",
                        "in": "query",
                        "description": "Filter refunds by organisation ID",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "subscription_id",
                        "in": "query",
                        "description": "Filter refunds by subscription ID",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Page number for pagination",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Refund history retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "refunds": {
                                            "properties": {
                                                "data": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "stripe_refund_id": {
                                                                "type": "string",
                                                                "example": "re_1234567890"
                                                            },
                                                            "amount": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "example": 50
                                                            },
                                                            "currency": {
                                                                "type": "string",
                                                                "example": "usd"
                                                            },
                                                            "status": {
                                                                "type": "string",
                                                                "example": "succeeded"
                                                            },
                                                            "refunded_at": {
                                                                "type": "string",
                                                                "format": "date-time",
                                                                "example": "2025-12-24T10:00:00Z"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                },
                                                "current_page": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "total": {
                                                    "type": "integer",
                                                    "example": 10
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/payment-intent/create": {
            "post": {
                "tags": [
                    "Billing - Stripe Payments"
                ],
                "summary": "Create Stripe payment intent for invoice",
                "description": "Creates a Stripe payment intent for paying an invoice. Requires director or super_admin role.",
                "operationId": "a3cffc27bb50d873ce84fea0fcf9e68e",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "invoice_id"
                                ],
                                "properties": {
                                    "invoice_id": {
                                        "description": "ID of the invoice to pay",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment intent created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "client_secret": {
                                            "description": "Stripe payment intent client secret for frontend",
                                            "type": "string",
                                            "example": "pi_1234567890_secret_abc123"
                                        },
                                        "payment_intent_id": {
                                            "description": "Stripe payment intent ID",
                                            "type": "string",
                                            "example": "pi_1234567890"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Failed to create payment intent"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - User does not have permission"
                    },
                    "404": {
                        "description": "Invoice not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/payment/confirm": {
            "post": {
                "tags": [
                    "Billing - Stripe Payments"
                ],
                "summary": "Confirm Stripe payment after successful transaction",
                "description": "Confirms a Stripe payment after the payment intent has been successfully processed. Updates invoice status and activates subscription. Requires director or super_admin role.",
                "operationId": "a39f4109071705bb6dfb8b55a3bd150b",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "payment_intent_id",
                                    "invoice_id"
                                ],
                                "properties": {
                                    "payment_intent_id": {
                                        "description": "Stripe payment intent ID",
                                        "type": "string",
                                        "example": "pi_1234567890"
                                    },
                                    "invoice_id": {
                                        "description": "ID of the invoice being paid",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Payment confirmed and processed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Payment processed successfully. Your subscription has been activated."
                                        },
                                        "payment": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "invoice_id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "amount": {
                                                    "type": "number",
                                                    "format": "float",
                                                    "example": 90
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "completed"
                                                },
                                                "payment_date": {
                                                    "type": "string",
                                                    "format": "date",
                                                    "example": "2025-12-24"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Payment not completed or already processed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - User does not have permission"
                    },
                    "404": {
                        "description": "Invoice not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/subscription/create": {
            "post": {
                "tags": [
                    "Billing - Stripe Subscriptions"
                ],
                "summary": "Create new Stripe subscription",
                "description": "Creates a new subscription for an organisation with the specified tier and user count. Requires director or super_admin role.",
                "operationId": "95aaa431e9647d50c29eae0456cd3e73",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "organisation_id",
                                    "tier",
                                    "user_count",
                                    "payment_method_id"
                                ],
                                "properties": {
                                    "organisation_id": {
                                        "description": "ID of the organisation",
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "tier": {
                                        "description": "Subscription tier",
                                        "type": "string",
                                        "enum": [
                                            "spark",
                                            "momentum",
                                            "vision"
                                        ],
                                        "example": "spark"
                                    },
                                    "user_count": {
                                        "description": "Number of users in the subscription",
                                        "type": "integer",
                                        "minimum": 1,
                                        "example": 5
                                    },
                                    "payment_method_id": {
                                        "description": "Stripe payment method ID",
                                        "type": "string",
                                        "example": "pm_1234567890"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Subscription created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Subscription created successfully"
                                        },
                                        "subscription": {
                                            "description": "Stripe subscription object",
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Failed to create subscription"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Organisation not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/subscription/add-user": {
            "post": {
                "tags": [
                    "Billing - Stripe Subscriptions"
                ],
                "summary": "Add user to subscription (pro-rata charge)",
                "description": "Adds a user to an existing subscription with pro-rata billing. Charges are calculated based on remaining days in the billing period. Requires director or super_admin role.",
                "operationId": "3f5e77a7ae2d706b3d79f491763a27d9",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "subscription_id",
                                    "organisation_id"
                                ],
                                "properties": {
                                    "subscription_id": {
                                        "description": "Stripe subscription ID",
                                        "type": "string",
                                        "example": "sub_1234567890"
                                    },
                                    "organisation_id": {
                                        "description": "ID of the organisation",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User added successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User added successfully"
                                        },
                                        "pro_rata_charge": {
                                            "description": "Pro-rata charge amount for the remaining days",
                                            "type": "number",
                                            "format": "float",
                                            "example": 3.33
                                        },
                                        "new_user_count": {
                                            "description": "Updated user count",
                                            "type": "integer",
                                            "example": 6
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Failed to add user"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Subscription not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/subscription/remove-user": {
            "post": {
                "tags": [
                    "Billing - Stripe Subscriptions"
                ],
                "summary": "Remove user from subscription (pro-rata credit)",
                "description": "Removes a user from an existing subscription with pro-rata credit. Credits are calculated based on active days in the billing period. Minimum 1 user must remain. Requires director or super_admin role.",
                "operationId": "ba110987a95d0f6e7e10d598ed64ba2c",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "subscription_id",
                                    "organisation_id"
                                ],
                                "properties": {
                                    "subscription_id": {
                                        "description": "Stripe subscription ID",
                                        "type": "string",
                                        "example": "sub_1234567890"
                                    },
                                    "organisation_id": {
                                        "description": "ID of the organisation",
                                        "type": "integer",
                                        "example": 1
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User removed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User removed successfully"
                                        },
                                        "pro_rata_credit": {
                                            "description": "Pro-rata credit amount for the active days",
                                            "type": "number",
                                            "format": "float",
                                            "example": 6.67
                                        },
                                        "new_user_count": {
                                            "description": "Updated user count (minimum 1)",
                                            "type": "integer",
                                            "example": 4
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Failed to remove user or minimum user count reached"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Subscription not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/billing/stripe/subscription/cancel": {
            "post": {
                "tags": [
                    "Billing - Stripe Subscriptions"
                ],
                "summary": "Cancel subscription",
                "description": "Cancels a Stripe subscription. By default, cancellation occurs at the end of the current billing period. Requires director or super_admin role.",
                "operationId": "d3756d5c9f999b45990819b8d4046a48",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "subscription_id"
                                ],
                                "properties": {
                                    "subscription_id": {
                                        "description": "Stripe subscription ID",
                                        "type": "string",
                                        "example": "sub_1234567890"
                                    },
                                    "cancel_at_period_end": {
                                        "description": "Cancel at end of billing period (default: true). If false, cancels immediately.",
                                        "type": "boolean",
                                        "example": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Subscription canceled successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Subscription canceled successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - Failed to cancel subscription"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Subscription not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/user-profile": {
            "get": {
                "tags": [
                    "User Profile"
                ],
                "summary": "Get user profile",
                "description": "Retrieve the authenticated user's complete profile information including personal details, organization, role, COT/SOT data, and timezone",
                "operationId": "c84e9a34f306458c51fa7fe86d304ad2",
                "responses": {
                    "200": {
                        "description": "User profile retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User Profile"
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "first_name": {
                                                    "type": "string",
                                                    "example": "John"
                                                },
                                                "last_name": {
                                                    "type": "string",
                                                    "example": "Doe"
                                                },
                                                "email": {
                                                    "type": "string",
                                                    "format": "email",
                                                    "example": "john.doe@example.com"
                                                },
                                                "officeId": {
                                                    "type": "integer",
                                                    "example": 1,
                                                    "nullable": true
                                                },
                                                "departmentId": {
                                                    "type": "integer",
                                                    "example": 1,
                                                    "nullable": true
                                                },
                                                "orgId": {
                                                    "type": "integer",
                                                    "example": 1,
                                                    "nullable": true
                                                },
                                                "officeName": {
                                                    "type": "string",
                                                    "example": "Main Office",
                                                    "nullable": true
                                                },
                                                "departmentName": {
                                                    "type": "string",
                                                    "example": "Engineering",
                                                    "nullable": true
                                                },
                                                "profileImage": {
                                                    "type": "string",
                                                    "example": "http://example.com/storage/profile-photos/image.jpg",
                                                    "nullable": true
                                                },
                                                "organisation_logo": {
                                                    "type": "string",
                                                    "nullable": true
                                                },
                                                "personaliseData": {
                                                    "type": "string",
                                                    "nullable": true
                                                },
                                                "status": {
                                                    "type": "string",
                                                    "example": "Active"
                                                },
                                                "userContact": {
                                                    "type": "string",
                                                    "example": "+1234567890",
                                                    "nullable": true
                                                },
                                                "country_code": {
                                                    "type": "string",
                                                    "example": "+1",
                                                    "nullable": true
                                                },
                                                "timezone": {
                                                    "description": "User's timezone from profile",
                                                    "type": "string",
                                                    "example": "America/New_York",
                                                    "nullable": true
                                                },
                                                "organisationName": {
                                                    "type": "string",
                                                    "example": "Acme Corp",
                                                    "nullable": true
                                                },
                                                "role": {
                                                    "type": "string",
                                                    "example": "organisation_user"
                                                },
                                                "created_at": {
                                                    "type": "string",
                                                    "format": "date-time",
                                                    "example": "2024-01-01T00:00:00.000000Z"
                                                },
                                                "cotTeamRoleMap": {
                                                    "type": "string",
                                                    "example": "Leader, Collaborator, Innovator"
                                                },
                                                "cotTeamRoleMapArr": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    }
                                                },
                                                "sotMotivationDetail": {
                                                    "type": "string",
                                                    "example": "Growth, Recognition, Autonomy"
                                                },
                                                "sotMotivationDetailArr": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    }
                                                },
                                                "sotDetail": {
                                                    "type": "string",
                                                    "example": ""
                                                },
                                                "perTypeStatus": {
                                                    "type": "boolean",
                                                    "example": false
                                                },
                                                "personalityTypeDetails": {
                                                    "type": "string",
                                                    "example": "You have not submitted your answers yet."
                                                },
                                                "personalityTypeDetailsArr": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User not authenticated"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Failed to fetch user profile"
                                        },
                                        "error": {
                                            "type": "string",
                                            "example": "Error message"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/update-user-profile": {
            "post": {
                "tags": [
                    "User Profile"
                ],
                "summary": "Update user profile",
                "description": "Update the authenticated user's profile information including name, phone, country code, timezone, and profile image",
                "operationId": "b8b9e9471112ba1ba1d5b549dfd9fa48",
                "requestBody": {
                    "required": false,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "maxLength": 255,
                                        "example": "John"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "maxLength": 255,
                                        "example": "Doe"
                                    },
                                    "phone": {
                                        "type": "string",
                                        "maxLength": 20,
                                        "example": "+1234567890"
                                    },
                                    "country_code": {
                                        "type": "string",
                                        "example": "+1"
                                    },
                                    "timezone": {
                                        "description": "Valid timezone identifier (e.g., America/New_York, Europe/London, Asia/Kolkata)",
                                        "type": "string",
                                        "maxLength": 50,
                                        "example": "America/New_York"
                                    },
                                    "profileImage": {
                                        "description": "Profile image file (jpg, jpeg, png, max 2MB)",
                                        "type": "string",
                                        "format": "binary"
                                    }
                                },
                                "type": "object"
                            }
                        },
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "maxLength": 255,
                                        "example": "John"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "maxLength": 255,
                                        "example": "Doe"
                                    },
                                    "phone": {
                                        "type": "string",
                                        "maxLength": 20,
                                        "example": "+1234567890"
                                    },
                                    "country_code": {
                                        "type": "string",
                                        "example": "+1"
                                    },
                                    "timezone": {
                                        "description": "Valid timezone identifier",
                                        "type": "string",
                                        "maxLength": 50,
                                        "example": "America/New_York"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Profile updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Profile updated successfully"
                                        },
                                        "data": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "first_name": {
                                                    "type": "string",
                                                    "example": "John"
                                                },
                                                "last_name": {
                                                    "type": "string",
                                                    "example": "Doe"
                                                },
                                                "email": {
                                                    "type": "string",
                                                    "format": "email",
                                                    "example": "john.doe@example.com"
                                                },
                                                "phone": {
                                                    "type": "string",
                                                    "example": "+1234567890",
                                                    "nullable": true
                                                },
                                                "country_code": {
                                                    "type": "string",
                                                    "example": "+1",
                                                    "nullable": true
                                                },
                                                "timezone": {
                                                    "description": "User's timezone from profile",
                                                    "type": "string",
                                                    "example": "America/New_York",
                                                    "nullable": true
                                                },
                                                "profileImage": {
                                                    "type": "string",
                                                    "example": "http://example.com/storage/profile-photos/image.jpg",
                                                    "nullable": true
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "User not authenticated"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "The given data was invalid."
                                        },
                                        "errors": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Failed to update profile"
                                        },
                                        "error": {
                                            "type": "string",
                                            "example": "Error message"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/timezone-list": {
            "get": {
                "tags": [
                    "User Profile"
                ],
                "summary": "Get timezone list",
                "description": "Retrieve a list of all available timezone identifiers that can be used for user profile timezone setting",
                "operationId": "b8f481b3a46ed3ec6ecd63b8d7d551d5",
                "responses": {
                    "200": {
                        "description": "Timezone list retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Timezone list retrieved successfully"
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "example": "America/New_York"
                                            },
                                            "example": [
                                                "America/New_York",
                                                "America/Chicago",
                                                "America/Denver",
                                                "America/Los_Angeles",
                                                "Europe/London",
                                                "Europe/Paris",
                                                "Asia/Kolkata",
                                                "Asia/Tokyo",
                                                "Australia/Sydney"
                                            ]
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthenticated"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/add-happy-index": {
            "post": {
                "tags": [
                    "Happy Index"
                ],
                "summary": "Submit daily mood/sentiment",
                "description": "Store a new Happy Index (mood status) entry for a user",
                "operationId": "046a736348fedbb50e6e83a42c0b3736",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "userId",
                                    "moodStatus"
                                ],
                                "properties": {
                                    "userId": {
                                        "type": "integer",
                                        "example": 1
                                    },
                                    "moodStatus": {
                                        "description": "1=Bad, 2=Okay, 3=Good",
                                        "type": "integer",
                                        "example": 3
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Feeling great today!"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Sentiment submitted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Sentiment submitted successfully!"
                                        },
                                        "data": {
                                            "properties": {
                                                "todayEIScore": {
                                                    "type": "string",
                                                    "example": "1250.50"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Already submitted today",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "You have already submitted your response"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/summary/{filterType}": {
            "get": {
                "tags": [
                    "Summary"
                ],
                "summary": "Get user summary by filter type",
                "description": "Retrieve user's Happy Index and leave summary based on filter type (this_week, last_7_days, previous_week, this_month, previous_month, custom, all)",
                "operationId": "c613b0866abb28c11d29fbb648cc4970",
                "parameters": [
                    {
                        "name": "filterType",
                        "in": "path",
                        "description": "Filter type for summary",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "this_week",
                                "last_7_days",
                                "previous_week",
                                "this_month",
                                "previous_month",
                                "custom",
                                "all"
                            ],
                            "example": "this_week"
                        }
                    },
                    {
                        "name": "start_date",
                        "in": "query",
                        "description": "Start date for custom filter (format: Y-m-d)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date",
                            "example": "2024-01-01"
                        }
                    },
                    {
                        "name": "end_date",
                        "in": "query",
                        "description": "End date for custom filter (format: Y-m-d)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date",
                            "example": "2024-01-31"
                        }
                    },
                    {
                        "name": "timezone",
                        "in": "query",
                        "description": "User timezone (optional)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "Asia/Kolkata"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Summary retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "date": {
                                                        "type": "string",
                                                        "example": "Jan 15, 2024"
                                                    },
                                                    "score": {
                                                        "type": "integer",
                                                        "example": 85,
                                                        "nullable": true
                                                    },
                                                    "mood_value": {
                                                        "description": "1=average, 2=sad, 3=happy",
                                                        "type": "integer",
                                                        "example": 3,
                                                        "nullable": true
                                                    },
                                                    "description": {
                                                        "type": "string",
                                                        "example": "Feeling great today!"
                                                    },
                                                    "image": {
                                                        "type": "string",
                                                        "example": "happy-app.png"
                                                    },
                                                    "status": {
                                                        "description": "Present, Out of office, or Missed",
                                                        "type": "string",
                                                        "example": "Present"
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Unauthenticated"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "Enter JWT token in format: Bearer {token}"
            }
        }
    },
    "tags": [
        {
            "name": "Basecamp Billing",
            "description": "Billing API endpoints for basecamp users ($10/month subscription)"
        },
        {
            "name": "Authentication",
            "description": "User authentication and registration endpoints"
        },
        {
            "name": "Billing - Refunds",
            "description": "Refund processing and history endpoints for Stripe payments"
        },
        {
            "name": "Billing - Stripe Payments",
            "description": "Stripe payment processing endpoints for invoices and subscriptions"
        },
        {
            "name": "Billing - Stripe Subscriptions",
            "description": "Stripe subscription management endpoints for creating, updating, and canceling subscriptions"
        },
        {
            "name": "User Profile",
            "description": "User profile management endpoints"
        },
        {
            "name": "Happy Index",
            "description": "Happy Index (mood tracking) endpoints"
        },
        {
            "name": "Summary",
            "description": "User summary endpoints for Happy Index and leave data"
        },
        {
            "name": "Payments",
            "description": "Payment processing endpoints for invoices"
        },
        {
            "name": "Basecamp Users",
            "description": "API endpoints specifically for basecamp users (individual $10/month subscription users)"
        }
    ]
}